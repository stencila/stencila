/* Article styles
 *
 * Schema: [Article](../../schema/Article.yaml)
 * Purpose: Document container for articles, including news and scholarly articles.
 * Provides structure for content, metadata, and document-level layout.
 *
 * DOM Structure:
 * <stencila-article id=xxx depth=0 ancestors='' repository='...' path='...' commit=xxx root>
 *     <section slot=title>
 *         <h1>
 *             <stencila-text id=xxx depth=2 ancestors=Article>Article title...</stencila-text>
 *         </h1>
 *     </section>
 *     <section slot=authors>
 *         ...
 *     </section>
 *     <section slot=abstract>
 *         ...
 *     </section>
 *     <section slot=content>
 *         <stencila-paragraph id=xxx depth=1 ancestors=Article>
 *             <p slot=content>
 *                 <stencila-text id=xxx depth=2 ancestors=Article.Paragraph>Article content...</stencila-text>
 *             </p>
 *         </stencila-paragraph>
 *         <!-- More content blocks... -->
 *     </section>
 *     <section slot=references>
 *         ...
 *     </section>
 * </stencila-article>
 *
 * Key Attributes:
 * - root: Boolean indicating if this is the root document element
 *
 * Slots:
 * - content: Required section containing all article content blocks
 * - title: Optional article title
 * - authors: Optional author information
 * - abstract: Optional article abstract
 * - references: Optional article references
 *
 * Notes:
 * - Articles serve as the main document container
 * - Content is wrapped in a section element for semantic structure
 * - Articles can contain any type of block content (paragraphs, headings, figures, etc.)
 * - When marked as root, articles receive document-level styling
 *
 * Examples: examples/conversion/article/article.dom.html
 */

:root {
    /* Article Content */
    --article-content-max-width: var(--content-width);
    --article-content-max-width-mobile: var(--content-width-mobile);

    /* Article Title - Typography optimized for large display text */
    --article-title-font-family: var(--heading-font-family);
    --article-title-font-size: calc(var(--text-font-size) * 2.5);
    --article-title-font-size-mobile: calc(var(--text-font-size-print) * 2.0);
    --article-title-font-size-print: calc(var(--text-font-size-print) * 2.0);
    --article-title-font-weight: var(--font-weight-bold);
    --article-title-color: var(--text-color-primary);
    --article-title-text-align: center;
    --article-title-margin-bottom: var(--space-8);

    /* Article Title - Line height (tighter than body text for large display typography) */
    --article-title-line-height: var(--line-height-tight);
    --article-title-line-height-mobile: var(--line-height-tight);

    /* Article Title - Layout */
    --article-title-max-width: calc(var(--article-content-max-width) * 0.9);

    /* Article Title - Fine-tuning (subtle negative tracking for large text) */
    --article-title-letter-spacing: -0.02em;

    /* Article Authors */
    --article-authors-font-size: var(--text-font-size);
    --article-authors-color: var(--text-color);
    --article-authors-text-align: left;
    --article-authors-margin-bottom: var(--space-6);

    /* Article Abstract */
    --article-abstract-font-size: var(--text-font-size);
    --article-abstract-color: var(--text-color);
    --article-abstract-background: var(--surface-background);
    --article-abstract-text-align: left;
    --article-abstract-max-width: var(--article-content-max-width);
    --article-abstract-margin-bottom: var(--space-6);

    /* Article Table of Contents */
    /* Values: none (default), true (enable with depth 3), or 1-6 (specific depth) */
    --article-toc: none;
    --article-toc-title: "Contents";
}

stencila-article {
    display: block;

    /* Non-content slots get constrained width */
    >[slot="title"],
    >[slot="authors"],
    >[slot="abstract"],
    >[slot="references"] {
        max-width: var(--article-content-max-width);
        margin-left: auto;
        margin-right: auto;
    }

    >[slot="title"] {
        /* Layout */
        max-width: var(--article-title-max-width);
        margin-bottom: var(--article-title-margin-bottom);

        /* Target both <h1> and <p> for title. See `impl DomCodec for Article`
        for why <p> is included */
        h1,
        p {
            /* Browser reset */
            margin: 0;

            /* Typography - Optimized for large display text */
            font-family: var(--article-title-font-family);
            font-size: var(--article-title-font-size);
            font-weight: var(--article-title-font-weight);
            line-height: var(--article-title-line-height);
            letter-spacing: var(--article-title-letter-spacing);
            color: var(--article-title-color);
            text-align: var(--article-title-text-align);
        }
    }

    >[slot="authors"] {
        font-size: var(--article-authors-font-size);
        color: var(--article-authors-color);
        text-align: var(--article-authors-text-align);
        margin-bottom: var(--article-authors-margin-bottom);
    }

    >[slot="abstract"] {
        font-size: var(--article-abstract-font-size);
        color: var(--article-abstract-color);
        background: var(--article-abstract-background);
        max-width: var(--article-abstract-max-width);
        margin-bottom: var(--article-abstract-margin-bottom);

        /* Apply text-align to nested "Abstract" heading and paragraph content */
        stencila-heading h1,
        stencila-paragraph p {
            text-align: var(--article-abstract-text-align);
        }
    }

    >[slot="headings"] {
        /* Temporarily hidden until pull styled */
        display: none;
    }

    /* Content slot: children get max-width, not the container
     * This allows breakout elements to exceed the default content width */
    >[slot="content"] {

        /* Default max-width for all direct children */
        >* {
            max-width: var(--article-content-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        /* Pass-through containers: full width, no constraints.
         * Their children get constraints via descendant selectors below. */
        stencila-section,
        stencila-styled-block {
            max-width: none;
            width: 100%;
            margin-left: 0;
            margin-right: 0;
        }

        /* Default constraints for children inside pass-through containers */
        stencila-section > *,
        stencila-styled-block [slot="content"] > * {
            max-width: var(--article-content-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        /* Breakout elements - wider max-width than default content
         * Using width: fit-content so elements are only as wide as needed,
         * up to the max-width limit.
         * Note: Using descendant selectors (no >) so these also apply inside
         * section and styled blocks which act as pass-through containers.
         * Each rule includes centering since they may not be direct children. */
        stencila-table {
            width: fit-content;
            max-width: var(--table-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-datatable {
            width: fit-content;
            max-width: var(--datatable-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-figure {
            width: fit-content;
            max-width: var(--figure-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-image-object {
            width: fit-content;
            max-width: var(--image-block-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-code-chunk {
            width: fit-content;
            max-width: var(--code-chunk-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-code-block {
            width: fit-content;
            min-width: var(--code-block-min-width);
            max-width: var(--code-block-max-width);
            margin-left: auto;
            margin-right: auto;
        }

        stencila-quote-block {
            width: fit-content;
            max-width: var(--quote-block-max-width);
            margin-left: auto;
            margin-right: auto;
        }
    }
}

/* Responsive Application - Mobile Breakpoint (640px) */
@media (max-width: 640px) {
    :root {
        --article-content-max-width: var(--article-content-max-width-mobile);
        --article-title-font-size: var(--article-title-font-size-mobile);
        --article-title-line-height: var(--article-title-line-height-mobile);
    }

    stencila-article {
        >[slot="content"] {
            /* Disable breakout on mobile - constrain all elements to viewport width */
            stencila-table,
            stencila-datatable,
            stencila-figure,
            stencila-image-object,
            stencila-code-chunk,
            stencila-code-block,
            stencila-quote-block {
                width: 100%;
                min-width: 0;
                max-width: 100%;
            }
        }
    }
}

@media print {
    :root {
        --article-title-font-size: var(--article-title-font-size-print);
    }

    stencila-article {
        /* Reset print margins for articles */
        max-width: none;
        padding: 0;
        margin: 0;

        /* Ensure content flows properly for print */
        section[slot] {
            max-width: none;
        }
    }
}