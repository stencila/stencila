/*
 * Tufte Theme
 *
 * A theme inspired by Edward Tufte's books and handouts.
 *
 * Inspired by
 *
 * https://edwardtufte.github.io/tufte-css/
 * https://github.com/ninivert/matplotlib_tufte/blob/7247f2cca514fbab8a82ef2c5d54d776790e2fc5/src/matplotlib_tufte/tufte.mplstyle
 * https://github.com/jrnold/ggthemes/blob/ca38c6250b17acc138b5cd5ccc45ab9e07234f3a/R/tufte.R
 */

@import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;1,400;1,600&family=Source+Code+Pro:wght@400;500&display=swap');

:root {
    /* Fonts
     *
     * Crimson Pro is a Bembo-like typeface (Tufte's books use Bembo). For the
     * most authentic implementation, consider self-hosting ET Book
     * (https://edwardtufte.github.io/et-book/). Palatino also appears in
     * Tufte's work. Gill Sans is Tufte's preferred sans-serif. For monospace,
     * Source Code Pro provides an elegant, cross-platform option via Google
     * Fonts. While Tufte-CSS prioritizes Consolas (Windows-only), Source Code
     * Pro offers similar refinement with broader compatibility. */
    --font-family-serif: 'Crimson Pro', 'Palatino Linotype', Palatino, ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif;
    --font-family-sans: 'Gill Sans', 'Gill Sans MT', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --font-family-mono: 'Source Code Pro', Consolas, ui-monospace, SFMono-Regular, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;

    /* Typography
     *
     * Tufte style uses refined typography with careful attention to spacing
     * and readability. Larger font size accommodates Crimson Pro's smaller
     * x-height and supports comfortable long-form reading. Slightly tighter
     * line-height (1.4) and subtle letter spacing create an elegant, scholarly
     * appearance. Narrower content width (55ch) ensures optimal reading comfort. */
    --text-font-size: var(--font-size-lg);
    --text-line-height: 1.4;
    --text-letter-spacing: 0.01em;
    --content-width: 55ch;

    /* Surface backgrounds
     *
     * Following the reference Tufte CSS implementation, use #fffff8 - a subtle
     * warm off-white that evokes quality paper while reducing harsh contrast.
     * This creates a book-like appearance appropriate for scholarly documents.
     * As noted in the original: "nearly indistinguishable from pure white, but
     * dials down the harsh contrast." */
    --surface-background: #fffff8;
    --surface-background-dark: #111111;

    /* Accent colors
     *
     * Tufte advocates using color sparingly, "reserving color for specific,
     * careful use in figures and images". Greyscale accents align with the
     * "maximum data, minimum ink" philosophy - functional rather than
     * decorative. */
    --color-accent: var(--color-gray-700);
    --color-accent-dark: var(--color-gray-500);
    --color-accent-muted: var(--color-gray-100);
    --color-accent-muted-dark: var(--color-gray-900);

    /* Content Spacing
     *
     * While Tufte's printed works use first-line indentation without vertical
     * spacing, web reading conventions favor vertical spacing for better
     * scannability and comprehension on screens. Moderate spacing maintains
     * the refined aesthetic while accommodating digital reading patterns.
     * This spacing applies to all content elements (paragraphs, lists, tables,
     * code blocks, etc.) for consistent vertical rhythm. */
    --content-spacing: var(--space-4);

    /* Headings
     *
     * Tufte uses subtle hierarchies - smaller size differences and consistent
     * weight create a more refined, scholarly appearance. Remove modern
     * negative letter-spacing for a classical typographic approach.
     * Following classical book design, h4-h6 use italic instead of bold. */
    --heading-font-size: calc(var(--text-font-size) * 1.5);
    --heading-font-size-ratio: 0.9;
    --heading-letter-spacing: 0;
    --heading-font-weight-decrement: 0;
    --heading-lower-font-style: italic;
    --heading-h4-font-weight: 400;
    --heading-h5-font-weight: 400;
    --heading-h6-font-weight: 400;

    /* Captions
     *
     * Slightly smaller sans-serif for contrast. */
    --caption-font-family: var(--font-family-sans);
    --caption-font-size: calc(var(--text-font-size) * 0.80);
    --caption-align: left;

    /* Tables
     *
     * Following Tufte's table design: horizontal rules only (top and bottom),
     * no vertical lines, no backgrounds, no hover effects. Clean typography
     * with ample spacing allows the data to speak for itself. */

    /* Outer borders - top and bottom only */
    --table-border-top-width: 1px;
    --table-border-bottom-width: 1px;
    --table-border-left-width: 0;
    --table-border-right-width: 0;

    /* Header separator - single rule below header */
    --table-header-border-bottom-width: 1px;

    /* Body rows - no interior borders */
    --table-body-row-border-width: 0;
    --table-column-border-width: 0;

    /* Minimal styling */
    --table-header-background: transparent;
    --table-header-background-print: transparent;
    --table-row-hover: transparent;
    --table-row-striped: transparent;
    --table-row-striped-print: transparent;
    --table-cell-padding: var(--space-3);

    /* Figures
     *
     * Minimal figure styling.
     * No borders or backgrounds - let the content stand alone. */
    --figure-border-width: 0;
    --figure-background: transparent;
    --figure-caption-font-family: var(--font-family-sans);
    --figure-caption-align: left;

    /* Lists
     *
     * Minimal list styling with simple markers and reduced spacing.
     * En-dash markers provide a clean, understated aesthetic. */
    --list-marker-content: '– ';
    --list-marker-nested-content: '– ';
    --list-marker-color: var(--text-color-muted);
    --list-item-spacing: calc(var(--content-spacing) * 0.3);

    /* Block Quotes
     *
     * Simple left border with italic text, no background or decorative
     * elements. Traditional scholarly quotation style. The italic styling
     * provides visual distinction without decorative backgrounds. */
    --quote-background: transparent;
    --quote-background-dark: transparent;
    --quote-border-width: 2px;
    --quote-border-color: var(--color-gray-400);
    --quote-border-color-dark: var(--color-gray-600);
    --quote-border-radius: 0;
    --quote-font-style: italic;
    --quote-font-size: var(--text-font-size);

    /* Code
     *
     * Minimal code styling with no borders. Font size reduced slightly for
     * a more refined appearance. Background tinting is handled by the base
     * theme which automatically darkens the parchment surface color. */
    --code-border-width: 0;
    --code-border-color: transparent;
    --code-font-size-inline: calc(var(--text-font-size) * 0.85);
    --code-font-size-block: calc(var(--text-font-size) * 0.85);

    /* Links
     *
     * Grayscale links with traditional underline. Scholarly and understated. */
    --link-color: var(--color-gray-700);
    --link-color-dark: var(--color-gray-400);
    --link-color-visited: var(--color-gray-600);
    --link-color-visited-dark: var(--color-gray-500);
    --link-color-hover: var(--color-gray-900);
    --link-color-hover-dark: var(--color-gray-200);
    --link-decoration: underline;
    --link-decoration-hover: underline;

    /* Admonitions
     *
     * Grayscale admonitions with minimal styling. Left border only,
     * no colored backgrounds - maintains document consistency. Slightly
     * increased padding provides comfortable breathing room. */
    --admonition-border-width: 0;
    --admonition-accent-border-width: 2px;
    --admonition-border-radius: 0;
    --admonition-padding: var(--space-4);
    --admonition-title-background-tint: 0%;
    --admonition-content-background-tint: 0%;
    --admonition-note-color: var(--color-gray-600);
    --admonition-note-color-dark: var(--color-gray-400);
    --admonition-info-color: var(--color-gray-600);
    --admonition-info-color-dark: var(--color-gray-400);
    --admonition-tip-color: var(--color-gray-600);
    --admonition-tip-color-dark: var(--color-gray-400);
    --admonition-important-color: var(--color-gray-700);
    --admonition-important-color-dark: var(--color-gray-300);
    --admonition-success-color: var(--color-gray-600);
    --admonition-success-color-dark: var(--color-gray-400);
    --admonition-failure-color: var(--color-gray-700);
    --admonition-failure-color-dark: var(--color-gray-300);
    --admonition-warning-color: var(--color-gray-700);
    --admonition-warning-color-dark: var(--color-gray-300);
    --admonition-danger-color: var(--color-gray-800);
    --admonition-danger-color-dark: var(--color-gray-200);
    --admonition-error-color: var(--color-gray-800);
    --admonition-error-color-dark: var(--color-gray-200);

    /* Code
     *
     * Solarized to match parchment background.
     */
    --code-theme: solarized-light;
    --code-theme-dark: solarized-dark;

    /* References
     *
     * Tufte's approach to references emphasizes readability and minimalism
     * over formal academic conventions. Smaller font size (similar to
     * sidenotes), left-aligned for easy scanning, compact spacing, and no
     * hanging indent for a cleaner, simpler presentation. */
    --reference-font-size: calc(var(--text-font-size) * 0.8);
    --reference-spacing: calc(var(--content-spacing) * 0.6);
    --reference-text-align: left;
    --reference-text-indent: 0;
    --reference-padding-left: 0;

    /* Thematic breaks */
    --thematic-break-border-width: 0.5px;
    --thematic-break-border-color: var(--color-gray-300);

    /* Diagrams
     *
     * Grayscale diagram styling consistent with overall theme minimalism.
     * Uses parchment background, serif typography, and subtle visual weight
     * to integrate seamlessly with the scholarly document aesthetic.
     *
     * Node backgrounds use very light fills (5%/10%/15% instead of the default
     * 15%/25%/35%) to reduce visual weight while maintaining readability.
     * A "full-Tufte" approach would use transparent backgrounds with borders
     * only, but this can reduce readability in complex diagrams with many
     * overlapping elements. The light fills strike a balance between Tufte's
     * "minimal ink" principle and practical diagram clarity. */
    --diagram-base-color: var(--color-gray-700);
    --diagram-base-color-dark: var(--color-gray-400);

    /* Use parchment background for seamless document integration */
    --diagram-background: var(--surface-background);
    --diagram-background-dark: var(--surface-background-dark);

    /* Serif typography consistent with body text */
    --diagram-font-family: var(--font-family-serif);

    /* Refined visual weight - thinner borders and edges */
    --diagram-node-border-width: 0.5px;
    --diagram-edge-width: 0.5px;

    /* Very subtle node fills - much lighter than defaults for refined appearance */
    --diagram-node-background: color-mix(in srgb, var(--diagram-base-color) 5%, var(--diagram-background));
    --diagram-node-background-dark: color-mix(in srgb, var(--diagram-base-color-dark) 5%, var(--diagram-background-dark));
    --diagram-node-background-secondary: color-mix(in srgb, var(--diagram-base-color) 10%, var(--diagram-background));
    --diagram-node-background-secondary-dark: color-mix(in srgb, var(--diagram-base-color-dark) 10%, var(--diagram-background-dark));
    --diagram-node-background-tertiary: color-mix(in srgb, var(--diagram-base-color) 15%, var(--diagram-background));
    --diagram-node-background-tertiary-dark: color-mix(in srgb, var(--diagram-base-color-dark) 15%, var(--diagram-background-dark));

    /* Plots
     *
     * Following Tufte's "data-ink ratio" principle: maximize data,
     * minimize decorative elements. Remove grids, borders, and backgrounds
     * to focus attention on the data itself. Transparent background ensures
     * plots integrate seamlessly with the document. */

    /* Color Palette - Start with darker grayscale for better contrast,
     * then muted categorical colors that don't overpower the data */
    --plot-color-1: hsl(0 0% 10%);        /* Darker gray for primary series */
    --plot-color-1-dark: hsl(0 0% 90%);
    --plot-color-2: hsl(210 70% 50%);     /* Muted blue */
    --plot-color-2-dark: hsl(210 60% 60%);
    --plot-color-3: hsl(25 85% 55%);      /* Muted orange */
    --plot-color-3-dark: hsl(25 75% 65%);
    --plot-color-4: hsl(135 55% 40%);     /* Muted green */
    --plot-color-4-dark: hsl(135 50% 50%);
    --plot-color-5: hsl(0 65% 50%);       /* Muted red */
    --plot-color-5-dark: hsl(0 60% 60%);

    /* Structure - Remove all non-data elements */
    --plot-panel-border: false;

    /* Grid - Completely removed per Tufte principles */
    --plot-grid-width: 0;

    /* Axes - Minimal presentation, could be set to 0 for range-frames */
    --plot-axis-line-width: 0.5px;
    --plot-tick-width: 0.5px;
    --plot-tick-size: var(--space-1);

    /* Legend - No borders or backgrounds */
    --plot-legend-border-width: 0;

    /* Lines - Thinner, more refined */
    --plot-line-width: 1.5px;

    /* Typography - Serif for plot text with increased sizes for clarity */
    --plot-font-family: var(--font-family-serif);

    /* Page Headers and Footers
     *
     * Following Tufte's understated approach: simple centered page numbers in
     * footer using serif font at slightly reduced size for subtlety. First page
     * (typically title page) has no page number. */
    --page-margin-font-family: var(--font-family-serif);
    --page-margin-font-size: calc(var(--text-font-size) * 0.9);
    --page-bottom-center-content: counter(page);
    --page1-bottom-center-content: '';
}

/* Root Element Refinements */

/* Oldstyle Numerals
 *
 * Oldstyle (or "text") numerals have varying heights and descenders,
 * blending more naturally with text than "lining" numerals. This creates
 * a more refined, classical typographic appearance typical of quality
 * book design and Tufte's aesthetic. */
[root] {
    font-variant-numeric: oldstyle-nums;
}

/* Strong and Emphasis Elements
 *
 * Tufte prefers subtlety over bold emphasis. Reduce strong weight to
 * semibold (600) instead of bold (700) for a more refined appearance.
 * This approach favors italic emphasis over heavy bold weights. */
[root] strong {
    font-weight: 600;
}

/* Print-specific overrides for authentic Tufte typography
 *
 * As noted in the content spacing comment above, Tufte's printed works use
 * first-line indentation without vertical spacing for a refined, book-like
 * appearance. For print, we restore these traditional typographic conventions
 * while keeping the web version readable with vertical spacing. */
@media print {
    :root {
        /* Paragraphs - Classic Tufte style with first-line indent, no spacing */
        --paragraph-spacing: 0;
        --paragraph-text-indent: 1.5em;
        --paragraph-text-align: justify;
        --paragraph-hyphens: auto;

        /* First paragraph after headings - no indent per book design convention */
        --paragraph-lead-text-indent: 0;

        /* Lists - Slightly more compact for print while maintaining elegance */
        --list-spacing: calc(var(--content-spacing) * 0.85);
        --list-item-spacing: calc(var(--content-spacing) * 0.25);

        /* Captions - Reduced for print economy */
        --caption-font-size: calc(var(--text-font-size) * 0.7);
    }
}
