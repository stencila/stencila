title: Instruction
"@id": stencila:Instruction
extends: Executable
abstract: true
category: edits
description: Abstract base type for a document editing instruction.
required:
  - messages
properties:
  messages:
    '@id': stencila:messages
    description: Messages involved in the instruction.
    $comment: |
      This array of messages starts with the initial instruction from the
      user and includes responses from the agent performing the instruction,
      and potentially further instructions for refinement by the user.
    type: array
    items:
      $ref: InstructionMessage
    dom:
      elem: div
  candidates:
    '@id': stencila:candidates
    description: A list of candidates for the assignee property.
    type: array
    items:
      type: string
    $comment: |
      This property is populated by Stencila to give the user a choice of potential assignees.
    proptest:
      min:
        description: No candidates
        value: None
      high:
        description: Generate a list of arbitrary ids using expected characters
        strategy: option::of(vec(r"[a-zA-Z][a-zA-Z\-_/.@]", size_range(1..5)))
      max:
        description: Generate a list of arbitrary assignee ids using any characters
        strategy: option::of(vec(String::arbitrary(), size_range(1..10)))
  assignee:
    '@id': stencila:assignee
    description: An identifier for the agent assigned to perform the instruction
    type: string
    $comment: |
      This property is a string because on creation of the instruction the identifier has not yet been
      resolved into a person, organization, or software application.
    proptest:
      min:
        description: No assignee
        value: None
      high:
        description: Generate an arbitrary id using expected characters
        strategy: option::of(r"[a-zA-Z][a-zA-Z\-_/.@]")
      max:
        description: Generate an arbitrary assignee id using any characters
        strategy: option::of(String::arbitrary())
  instructionStatus:
    '@id': stencila:instructionStatus
    description: Whether the instruction has a suggestion that has been proposed, accepted, revised, or rejected.
    $comment: |
      Note that `Instruction` nodes also have an `executionStatus` property. This property is distinct in that
      it captures the status of the instruction after at least one execution i.e. once it has the `suggestion`
      property populated.
    strip: [metadata]
    $ref: InstructionStatus
  authors:
    '@id': schema:author
    description: The authors of the instruction.
    type: array
    items:
      $ref: Author
    strip: [metadata]
    dom:
      elem: div
