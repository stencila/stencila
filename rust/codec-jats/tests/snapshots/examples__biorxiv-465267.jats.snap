---
source: rust/codec-jats/tests/examples.rs
expression: jats
---
<article dtd-version="1.3" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML">
  <front>
    <abstract>
      <p>The use of null models has been a cornerstone to assess the emergence of many network properties at different levels of organization (micro-, meso- and macroscale). Notwithstanding, the debate around which is the most appropriate randomization procedure for a given problem is far from being over. Within the ecological community, for example, the discussion around whether nestedness is –or is not– a frequent pattern in natural systems, and under which assumptions, remains open. For this particular problem, efforts have been devoted to exploring to what extent current models are vulnerable to statistical errors, or to introduce new models that employ different randomization procedures. However, few or no attention has been devoted to the performance of those null models against other architectures. Here, we show that assessing alternative structures under a single null model may produce ambiguous results, which difficult the comparison regarding the joint emergence of different arrangements within a single network. To this aim, we analyze the statistical significance –in terms of<italic>z</italic>-scores– of nestedness, modularity, and in-block nestedness scores, employing five different null models on a benchmark of ∼ 2.5 × 10<sup>4</sup>synthetic bipartite networks with prescribed levels of the mentioned patterns. We show that some null models systematically over- or underestimate the presence of one or another structural pattern. In light of these ambiguities, we introduce an alternative model (termed Corrected Probabilistic model) that reduces the observed biases towards under- and overestimation, and highlight the need for the development of new frameworks that take into account those biases.</p>
    </abstract>
  </front>
  <body>
    <sec sec-type="Introduction">
      <title level="1">INTRODUCTION</title>
      <p>Almost twenty years ago, research in community ecology was deeply challenged by the evidence that biota interactions, rather than being randomly assembled, manifest clear architectural patterns. In 2003, the pioneer paper of Bascompte<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c1">1</xref>&#10;</sup>showed that a significant amount of mutualistic plant-animal networks are organized according to well-defined nested arrangements. Along the same line, Olesen<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c2">2</xref>&#10;</sup>unveiled the prevalence of modular configuration among pollination communities with a high (&gt; 150) number of species. In the following years, both nestedness and modularity were recognized to strongly affect some beneficial properties –the former was linked to the promotion of diversity<sup>&#10;<xref ref-type="bibr" rid="c3">3</xref>&#10;</sup>and the maximization of abundances<sup>&#10;<xref ref-type="bibr" rid="c4">4</xref>&#10;</sup>, while the latter was associated to the enhancing of stability<sup>
          <xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c6">6</xref>
        </sup>– leading to a great consensus about the crucial role they play in the dynamics of natural systems<sup>
          <xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref>,<xref ref-type="bibr" rid="c15">15</xref>
        </sup>.</p>
      <p>The importance of interaction structure in the behavior of ecological communities fueled, consequently, a long series of studies aimed to assess the statistical significance of the emergent patterns. Herein, null models stand up as one of the ubiquitous tools to address this class of problems, in particular referring to nestedness<sup>
          <xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c17">17</xref>
        </sup>. Paraphrasing Gotelli and Graves<sup>&#10;<xref ref-type="bibr" rid="c18">18</xref>&#10;</sup>, a null model is a pattern-generating model, designed with respect to some ecological or evolutionary process of interest, which allows for randomization test of ecological data, for instance, a species’ network (as in our case). Certain elements of the network are held constant (constraints), and others are permitted to vary stochastically to create new assemblages. In this way, a null model generates a set of objects that match the original one only in the selected constraints and may be employed as a term of comparison to infer wether the network in question displays nontrivial features, such as the architectural pattern, as a consequence of those constraints, namely as a result of a null hypothesis embodying a particular ecological mechanism.</p>
      <p>The selection of these constraints has important effects, and yields many controversial aspects concerning the use of null models. On the one hand, dealing with too loose constraints could misguide us to think that a structural pattern really exists (type I error)<sup>
          <xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c20">20</xref>
        </sup>. On the other hand, imposing too strict constraints will increase the chance of falsely rejecting the statistical significance of the considered pattern (type II error)<sup>
          <xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c21">21</xref>
        </sup>. For instance, if the null hypothesis refers to species interactions, the first point of view could translate into an ensemble of networks in which degrees are proportionally constrained, matching only on average the marginal total of the original matrix<sup>&#10;<xref ref-type="bibr" rid="c1">1</xref>&#10;</sup>. The second approach, instead, might fix node degrees by swapping pairs of interactions such that both row and column totals are preserved<sup>&#10;<xref ref-type="bibr" rid="c22">22</xref>&#10;</sup>. Intuitively, the former algorithms avail themselves of ample room to generate random structures, thus often inducing a type I error. While the latter will tend to generate null matrices that closely resemble the original network and so, in order to get a truly representative ensemble, a very large number of null matrices needs to be produced, something which is not possible in some scenarios and could lead to the generation of a biased sample.</p>
      <p>Since the 70s, scholars have struggled to overcome the aforementioned limitations<sup>
          <xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref>
        </sup>. Later, a myriad of papers have addressed the ambiguities in pattern assessment, both improving existing algorithms, and introducing new ones<sup>
          <xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref>
        </sup>. Many of these, however, present some limitations that need to be further explored or extended, both on the conceptual and technical side. First, many of the works about null models take into account a reduced number of real world networks<sup>
          <xref ref-type="bibr" rid="c30">30</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c32">32</xref>
        </sup>. Such procedure implies, to some extent, circularity. For example, testing for nestedness via randomization on an empirical network for which we would like to know whether it presents nestedness or not. Some authors have considered large synthetic networks ensembles,<italic>e</italic>.<italic>g</italic>., Strona<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c21">21</xref>&#10;</sup>employed an ensemble of 10<sup>3</sup>synthetic networks, but it only considered square networks with up to 50 rows and columns. In general, there is still a lack of a proper synthetic benchmark aimed to build prescribed architectural patterns. The assessment of nestedness (or any other pattern, for that matter), indeed, is often performed over random matrices, and the few papers dealing with effective nested matrices generate them in a contrived way. One exception, at the best of our knowledge, is provided by the work of Beckett<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c33">33</xref>&#10;</sup>.</p>
      <p>Moreover, another pressing issue relates to the structural arrangements under consideration. So far, the debate has focused almost exclusively on nestedness, while modularity, for example, has been mostly left aside with few exceptions<sup>
          <xref ref-type="bibr" rid="c34">34</xref>,<xref ref-type="bibr" rid="c35">35</xref>
        </sup>. Considering the ecological implications of exhibiting one or another pattern, null models should be balanced enough to discriminate correctly among the different possibilities. Furthermore, note that, in addition to nestedness and modularity, there are other architectural patterns worth being considered,<italic>e</italic>.<italic>g</italic>. in-block nestedness, which describes networks compound by weakly interlinked blocks with internal nested character<sup>
          <xref ref-type="bibr" rid="c36">36</xref>,<xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c38">38</xref>
        </sup>. This has recently attracted a lot of attention to be predominant in real mutualistic communities<sup>&#10;<xref ref-type="bibr" rid="c39">39</xref>&#10;</sup>and to emerge as a consequence of micro-<sup>
          <xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c41">41</xref>
        </sup>and macroscopic<sup>&#10;<xref ref-type="bibr" rid="c42">42</xref>&#10;</sup>mechanisms.</p>
      <p>In the current manuscript, we first introduce a network generation benchmark which enables the construction of synthetic graphs with varying levels of specified planted structures (from nested, to modular, to in-block nested, to completely random patterns). On top of such benchmark, we analyze the statistical significance –in terms of z-scores– of three rich sets of bipartite matrices with nested, modular and in-block nested configuration. We consider five different null models and detect the presence of ambiguities in assessing the various network descriptors, corresponding to over- (or under-) estimations of the given arrangements. To overcome the observed inconsistencies, we introduce an alternative approach, the Corrected Probabilistic model, that helps to reduce the observed under- and overestimation, and highlights the need for the development of new frameworks that take into account those biases. These contributions are wrapped into a single compact framework, consisting of software repositories that enable the generation of the synthetic networks with the specified planted structures, the calculation of nestedness under different formulations, optimization algorithms for the maximization of modularity and in-block nestedness, and the construction of the reviewed null models.</p>
      <p>The article is organized as follows:<ext-link xlink:href="#s2a">Section 2.1</ext-link>provides the definitions for nestedness, modularity, and in-block nestedness.<ext-link xlink:href="#s2b">Section 2.2</ext-link>provides the details of the suitable synthetic network generation benchmark, that is employed in this work.<ext-link xlink:href="#s2c">Section 2.3</ext-link>offers details regarding the empirical data we analyzed.<ext-link xlink:href="#s2d">Section 2.4</ext-link>introduces the five null models that will be studied in this work.<ext-link xlink:href="#s3">Section 3</ext-link>presents the results of our study in both the synthetic and empirical benchmarks. Finally, the discussion in<ext-link xlink:href="#s4">Section 4</ext-link>summarizes all the previous and highlights the main open challenges for further developments.</p>
    </sec>
    <sec sec-type="Materials">
      <title level="1">MATERIALS AND METHODS</title>
      <sec>
        <title level="2">Relevant structural patterns in Ecological Networks</title>
        <p>We present here the three structural arrangements considered in the manuscript: nestedness at the macroscale, modularity and in-block nestedness at the mesoscale. We provide their definition and discuss the related properties, paying particular attention to the measures aimed to quantify them –implemented and available at<ext-link xlink:href="https://github.com/COSIN3-UOC/N-Q-IBN">https://github.com/COSIN3-UOC/N-Q-IBN</ext-link>.</p>
        <sec>
          <title level="3">Nestedness</title>
          <p>Nestedness, originally conceived in the field of biogeography<sup>
              <xref ref-type="bibr" rid="c43">43</xref>,<xref ref-type="bibr" rid="c44">44</xref>,<xref ref-type="bibr" rid="c45">45</xref>
            </sup>, constitutes a frequent architectural pattern both inside<sup>
              <xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c13">13</xref>
            </sup>and outside Ecology<sup>
              <xref ref-type="bibr" rid="c46">46</xref>,<xref ref-type="bibr" rid="c47">47</xref>,<xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c49">49</xref>,<xref ref-type="bibr" rid="c15">15</xref>
            </sup>. A perfect nested configuration describes a hierarchical organization where the set of neighbors of a node is a subset of the neighborhoods of larger degree nodes. That is, given a graph G and let V be the set of its vertexes, a perfectly nested configuration exists if&#10;</p>
          <disp-formula code="" id="eqn1">
          </disp-formula>
          <p>&#10;where<italic>k</italic>
            <sub>&#10;<italic>n</italic>&#10;</sub>and Γ<sub>&#10;<italic>n</italic>&#10;</sub>indicate the degree of a node<italic>n</italic>and its neighborhood, respectively<sup>&#10;<xref ref-type="bibr" rid="c1">1</xref>&#10;</sup>. In terms of adjacency matrixes, this definition translates into the characteristic triangular shape, as that shown in<ext-link xlink:href="#fig1">Fig. 1 a</ext-link>.</p>
          <fig id="fig1">
            <label>1</label>
            <caption>
              <p>Idealised examples of adjacency matrices associate to nested (<bold>a</bold>), modular (<bold>b</bold>), in-block nestedness (<bold>c</bold>) networks. For perfect nested networks, the adjacency matrix manifests a triangular structure, while in the modular case it is divided in blocks, exhibiting a high internal connectivity and a low one. The adjacency matrix of an in-block nested matrix is divided in blocks with an internal nested structure.</p>
            </caption>
            <inline-graphic xlink:href="465267v1_fig1">
            </inline-graphic>
          </fig>
          <p>Even though perfectly nested patterns are extremely rare in real complex networks, many of these exhibit a highly nested haracter. Quantifying nestedness has rendered itself a large amount of definitions<sup>&#10;<xref ref-type="bibr" rid="c50">50</xref>&#10;</sup>. From an algebraic perspective, the spectral properties of perfectly nested graphs have been studied by mathematicians<sup>
              <xref ref-type="bibr" rid="c51">51</xref>,<xref ref-type="bibr" rid="c52">52</xref>
            </sup>facilitating the proposal of the detection method of Staniczenko<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c11">11</xref>&#10;</sup>, which quantifies nestedness with respect to the maximum eigenvalue of binary and weighted graphs’ adjacency matrices. Ecologists have also dedicated many efforts to evaluate nestedness in real systems. In first place, there are measures based on counting misplaced relations to complete a perfect upper triangular nested structure in the biadjacency matrix, such as the Nested Temperature (NT) measure, introduced by Atmar and Patterson<sup>&#10;<xref ref-type="bibr" rid="c53">53</xref>&#10;</sup>. To overcome some pitfalls around placement-based measures, Almeida-Neto<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c54">54</xref>&#10;</sup>developed overlap metrics, like the Node Overlap and Decreasing Fill (NODF), which considers the amount of common neighbours between every two pairs of nodes in matrix A, alongside with its weighted version<sup>
              <xref ref-type="bibr" rid="c55">55</xref>,<xref ref-type="bibr" rid="c56">56</xref>,<xref ref-type="bibr" rid="c57">57</xref>
            </sup>.</p>
          <p>In this work, we stick to a NODF-like descriptor, which for the case of a bipartite network writes as&#10;</p>
          <disp-formula code="" id="eqn2">
          </disp-formula>
          <p>&#10;where<italic>N</italic>
            <sub>&#10;<italic>r</italic>&#10;</sub>and<italic>N</italic>
            <sub>&#10;<italic>c</italic>&#10;</sub>represent the number of adjacency matrix rows and columns, respectively;<italic>O</italic>
            <sub>&#10;<italic>ij</italic>&#10;</sub>= Σ<sub>&#10;<italic>k</italic>&#10;</sub>
            <italic>a</italic>
            <sub>&#10;<italic>ik</italic>&#10;</sub>
            <italic>a</italic>
            <sub>&#10;<italic>jk</italic>&#10;</sub>, and similarly,<italic>O</italic>
            <sub>
              <italic>lm</italic>,</sub>account for the amount of commonly shared neighbours –a.k.a overlap– between pair of species (row or column node pairs);<italic>k</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>= Σ<sub>&#10;<italic>k</italic>&#10;</sub>
            <italic>a</italic>
            <sub>&#10;<italic>ik</italic>&#10;</sub>corresponds to the degree of node i and quantifies the number of species with whom i is related to; and Θ (·) is the Heaviside step function, that ensures that<sub>&#10;<italic>ij</italic>&#10;</sub>has a positive contribution when<italic>k</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>≥<italic>k</italic>
            <sub>&#10;<italic>j</italic>&#10;</sub>. Additionally,<italic>O</italic>
            <sub>&#10;<italic>ij</italic>&#10;</sub>is conveniently corrected by a null model that discounts the expected change of each species have to share a neighbor<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>, namely, the expected overlap ⟨<italic>O</italic>
            <sub>&#10;<italic>ij</italic>&#10;</sub>⟩ Assuming no correlation between neighboring species of<italic>i</italic>and<italic>j</italic>the probability .of sharing a particular neighbour only depends on the degree of<italic>i</italic>and<italic>j</italic>and on size of the network,<inline-formula code="">
            </inline-formula>. Hence, the average overlap is<inline-formula code="">
            </inline-formula>. The same argument applies for the other set of species (<italic>k</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>
            <italic>k</italic>
            <sub>&#10;<italic>m</italic>&#10;</sub>) /<italic>N</italic>
            <sub>&#10;<italic>r</italic>&#10;</sub>. Note that<ext-link xlink:href="#eqn2">Eq. 2</ext-link>follows closely (and often reduces exactly) to NODF (Almeida-Neto<italic>et al</italic>.) if the term ⟨<italic>O</italic>
            <sub>&#10;<italic>ij</italic>&#10;</sub>⟩ is suppressed. We chose to employ this metric to assess nestedness, instead of the original NODF since it also incorporates a term that discounts the expected overlap among pairs of nodes. Notwithstanding, as we will show in<ext-link xlink:href="#s3">Sec.3</ext-link>, our results for the statistical significance of nested networks over the different null models are robust against other existing metrics,<italic>i</italic>.<italic>e</italic>. spectral radius, and the original NODF.</p>
        </sec>
        <sec>
          <title level="3">Modularity</title>
          <p>Modular networks are those built up from weakly interlinked groups (also called communities, modules, compartments, clusters) with high internal connectivity.<ext-link xlink:href="#fig1">Fig. 1 b</ext-link>depicts the adjacency matrix of a perfectly modular network,<italic>i</italic>.<italic>e</italic>. with no intergroup links. Modular structure is a rather ubiquitous mesoscale architecture<sup>
              <xref ref-type="bibr" rid="c58">58</xref>,<xref ref-type="bibr" rid="c59">59</xref>,<xref ref-type="bibr" rid="c60">60</xref>,<xref ref-type="bibr" rid="c61">61</xref>
            </sup>and appears in several fields, as diverse as biology<sup>&#10;<xref ref-type="bibr" rid="c59">59</xref>&#10;</sup>and cognitive science<sup>&#10;<xref ref-type="bibr" rid="c62">62</xref>&#10;</sup>.</p>
          <p>The problem of identifying community structure constitutes itself a sub-area of network science. Over the last decades, scholars have developed a rich collection of algorithms and methodologies to infer these communities from relational data<sup>
              <xref ref-type="bibr" rid="c61">61</xref>,<xref ref-type="bibr" rid="c63">63</xref>
            </sup>. Probably, the most popular method in network science, and in particular in Ecology, is through the maximization of a fitness function called modularity<italic>Q</italic>∈ [0, 1)<sup>&#10;<xref ref-type="bibr" rid="c64">64</xref>&#10;</sup>. We will also employ this function in the present work. Formally, the modularity measure can be written as&#10;</p>
          <disp-formula code="" id="eqn3">
          </disp-formula>
          <p>&#10;where<italic>A</italic>is the biadjacency matrix,<italic>L</italic>is the total number of links in the network,<inline-formula code="">
            </inline-formula>is a vector representing the membership ariable of species with entries<italic>α</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>,<italic>δ</italic>(<italic>α</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>,<italic>α</italic>
            <sub>&#10;<italic>j</italic>&#10;</sub>) corresponds to the Kronecker delta, equal to one if nodes<italic>i</italic>and<italic>j</italic>belong to the same community (zero otherwise) and<italic>k</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>
            <italic>k</italic>
            <sub>&#10;<italic>j</italic>&#10;</sub>
            <italic>/L</italic>is a regularisation term to discount the expectation that two nodes are connected by chance considering the degree they have.</p>
        </sec>
        <sec>
          <title level="3">In-block nestedness</title>
          <p>Over the last decade, nestedness and modularity have concentrated most of the attention in community ecology, as they seem to have deep implications on the dynamics and other ecological properties. Nestedness, indeed, promotes the diversity of species<sup>&#10;<xref ref-type="bibr" rid="c3">3</xref>&#10;</sup>, but restrains instead the local asymptotic stability<sup>
              <xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c11">11</xref>
            </sup>, a quality that is maximized by modular organization<sup>
              <xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c6">6</xref>
            </sup>. This suggests that natural systems, which are often observed to be diverse and stable at the same time, develop jointly nestedness and modularity.</p>
          <p>The existence of concurrent nested and modular organizations has been debated in different situations<sup>
              <xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c49">49</xref>
            </sup>, but empirical<sup>&#10;<xref ref-type="bibr" rid="c34">34</xref>&#10;</sup>and later analytical<sup>&#10;<xref ref-type="bibr" rid="c65">65</xref>&#10;</sup>evidence proved that macroscale nestedness and modular mesoscale cannot coexist easily<sup>&#10;<xref ref-type="bibr" rid="c65">65</xref>&#10;</sup>. This apparent incompatibility is due to the fact that the two patterns arise as a consequence of different mechanisms: certain pressures promote the block organization, while others favor the emergence of nested patterns. Actually, the analysis of these mechanisms suggests that the co-occurrence of nestedness and modularity may take place at different scales. Herein, in-block nestedness stands out as a hybrid architecture that results from recasting nestedness at the mesoscale,<italic>i</italic>.<italic>e</italic>., within modules<sup>
              <xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c38">38</xref>
            </sup>.</p>
          <p>In-block nestedness depicts a network configuration where weakly connected blocks exhibit an internal nested assembly (see<ext-link xlink:href="#fig1">Fig. 1 c</ext-link>), and was first introduced by Lewinson<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c36">36</xref>&#10;</sup>. This has been found to unfold from an abundance-maximization process<sup>&#10;<xref ref-type="bibr" rid="c4">4</xref>&#10;</sup>on top of a niche-structured population<sup>
              <xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c41">41</xref>
            </sup>, providing a bottom-up perspective on nestedness-modularity, able to trade off stability and diversity in mutualistic communities<sup>&#10;<xref ref-type="bibr" rid="c39">39</xref>&#10;</sup>. Significantly, in-block nestedness has been shown to be the predominant pattern in a significant amount of real plant-animal communities<sup>&#10;<xref ref-type="bibr" rid="c39">39</xref>&#10;</sup>, as well as outside of ecology<sup>&#10;<xref ref-type="bibr" rid="c66">66</xref>&#10;</sup>.</p>
          <p>The original approaches<sup>
              <xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c67">67</xref>,<xref ref-type="bibr" rid="c36">36</xref>
            </sup>to detect nested compartments started first optimizing modularity, then subsequently computing the level of nestedness exclusively for nodes within the detected communities. Although this sequential procedure delivers good results in many situations (since, often, detected modules gather nodes with degree heterogeneity), a specialized fitness function is required for the general case. Thus, as in the case of modularity, in-block nestedness detection is a hard computational problem where the use of heuristic algorithms is mandatory. Using the formulation developed in<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>, the degree of in-block nestedness of a network ℐ can be computed as&#10;</p>
          <disp-formula code="" id="eqn4">
          </disp-formula>
          <p>&#10;where<italic>C</italic>
            <sub>&#10;<italic>i</italic>&#10;</sub>and<italic>C</italic>
            <sub>&#10;<italic>l</italic>&#10;</sub>are the size of the communities where nodes i and<italic>l</italic>belongs to. Worth highlighting this hybrid structure reframes nestedness, originally a macroscale feature, to the mesoscopic level. In this sense, a perfectly nested structure corresponds to an in-block nested structure with a single community, i.e.<ext-link xlink:href="#eqn4">Eq. 4</ext-link>reduces<italic>exactly</italic>to<ext-link xlink:href="#eqn2">Eq. 2</ext-link>when<italic>B</italic>= 1.</p>
        </sec>
      </sec>
      <sec>
        <title level="2">Synthetic benchmark</title>
        <p>We carry out the analysis of the robustness of different types of null models over three sets of synthetic networks with the three patterns of interest. So far, many of the works concerning the study of structured interactions in Ecology proceed by quantifying the degree of a given pattern over networks with a random organization, or nested networks constructed in contrived way. The only exception, to the best of our knowledge, is constituted by Beckett and Williams<sup>&#10;<xref ref-type="bibr" rid="c33">33</xref>&#10;</sup>, who construct synthetic perfect nested matrices with varying levels of connectance, by employing the unit ball equation, and then iteratively perform rewires to degrade the ideal structure, introducing noise. Thus, one of the main contributions of the current manuscript is the generation of networks with a well-defined structure, as a variation of the model introduced in<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>, and available at<ext-link xlink:href="https://github.com/COSIN3-UOC/network-generator">https://github.com/COSIN3-UOC/network-generator</ext-link>. In our framework, the different architectural configurations are controlled by four tunable parameters: the number of communities<italic>B</italic>∈ [1, ∞], the inter-community noise<italic>μ</italic>∈ [0, 1], the noise outside the perfect nested structure<italic>p</italic>∈ [0, 1], and the shape parameter controlling the slimness of the nested profile<italic>ξ</italic>∈ [1, ∞].</p>
        <p>The construction of an<italic>N×N</italic>adjacency matrix (the extension to rectangular matrixes is straightforward) with a given structure arts off by fixing the number of blocks. Particularly, we build [<italic>B</italic>] blocks of size [<italic>N/B</italic>] and another with the remaining<italic>N</italic>− [<italic>N/B</italic>] nodes, where [.] represents the integer part function. The intra-block structure is obtained by first generating a perfect nested configuration, which shape depends on the parameter<italic>ξ</italic>; as&#10;</p>
        <disp-formula code="" id="eqn5">
        </disp-formula>
        <p>&#10;inspired by the unit ball equation. Specifically, a block with<italic>N</italic>
          <sub>B</sub>nodes is constructed by tessellating the [0, 1] × [0, 1] space into<inline-formula code="">
          </inline-formula>squares and adding a link into each entry whose center lies above the curve in<ext-link xlink:href="#eqn5">Eq. 5</ext-link>. The resulting perfect nested blocks are rarely found in real systems, thus we introduce a noise relying on a dual-step procedure: a fraction<italic>p</italic>of links lying above the curve in<ext-link xlink:href="#eqn5">Eq 5</ext-link>are randomly selected and then distributed across the empty entries of the block. Similarly, we reproduce inter-block perturbations with an additional noise procedure ruled by the parameter<italic>μ</italic>: for each block, each link is removed with probability<italic>p</italic>
          <sub>&#10;<italic>i</italic>&#10;</sub>=<italic>μ</italic>(<italic>&#10;<bold>B</bold>&#10;</italic>− 1)<italic>&#10;<bold>B</bold>&#10;</italic>and then distributed at random to connect a node of the original block to another of a different one.</p>
        <p>
          <ext-link xlink:href="#fig2">Figure 2</ext-link>shows several synthetic networks related to different values of the model parameters. The first row refers to nested matrices, which can be obtained by setting<italic>B</italic>= 1 and<italic>μ</italic>= 0,<italic>i</italic>.<italic>e</italic>. considering only one block, and are fully characterized by the choice of<italic>ξ</italic>and<italic>p</italic>. From left to right, the former parameter takes increasing values and the resulting nested shape becomes more and more slight. The value of<italic>p</italic>, instead, decreases from left to right. The situation in which<italic>&#10;<underline>p</underline>&#10;</italic>= 1 yields to a Erdös-Rényi graph. The middle row presents a few examples of modular matrices, exhibiting a different number of blocks<italic>B</italic>. These are obtained by setting<italic>p</italic>= 1 in order to get rid of any intra-block structure, while<italic>ξ</italic>is fixed according the wished edge density. The parameter<italic>μ</italic>allows to interpolate between a purely modular network (<italic>μ</italic>= 0),<italic>i</italic>.<italic>e</italic>. without inter-blocks links, and an Erdös-Rény one (<italic>μ</italic>= 1). Finally, the third row portrays in-block nested matrices associated to several parameter choices, paying particular attention to the role of<italic>p</italic>and<italic>μ</italic>. In the limit in which<italic>p</italic>=<italic>μ</italic>= 0 we have a purely in-block nested configuration, while for<italic>p</italic>=<italic>μ</italic>= 1 an Erdös-Rény arises.</p>
        <fig id="fig2">
          <label>2</label>
          <caption>
            <p>Examples of synthetic network generation with the model introduced in<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>. The top row shows the results for the generation of nested networks (<italic>B</italic>= 1) and the effects of varying<italic>ξ</italic>and<italic>p</italic>parameters. Middle row exhibits results for modular networks with varying levels on the number of blocks<italic>B</italic>and the inter-block parameter<italic>μ</italic>. Finally, the bottom row corresponds to in-block nested networks, and provides some examples of the effect of the noise parameters<italic>p</italic>and<italic>μ</italic>.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig2">
          </inline-graphic>
        </fig>
        <fig id="fig3">
          <label>3</label>
          <caption>
            <p>Corrected probabilistic model illustration. In the left we have the original matrix, while on the right the result of the null model randomization is shown. In this framework, the presence of a link is ruled by<ext-link xlink:href="#eqn10">Equation (10)</ext-link>, which extends Bascompte’s model by taking into account the fact that row and column sampling processes are not independent. Particularly, the figure shows a situation where the row sampling introduces a link (in the fourth row) which affects the third column degree. Accordingly, the probability to have links in a given column is corrected by resting a quantity embodying the probability that a fraction of these links already exists because of the row sampling. In a first approximation, such an additional term may be reduced to the average row degree.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig3">
          </inline-graphic>
        </fig>
        <p>The generative process described above may be implemented in terms of edge probabilities, simplifying the process of algorithmic design. The probability of having a link between nodes<italic>i</italic>and<italic>j</italic>within a block writes as&#10;</p>
        <disp-formula code="" id="eqn6">
        </disp-formula>
        <p>&#10;The first term within square brackets, (1 −<italic>p</italic>), embodies the probability of not altering a link, while the second,<italic>pp</italic>
          <sub>&#10;<italic>r</italic>&#10;</sub>, provides that of recovering a link after removal in the random dispersion of removed links. The Heaviside function restricts them to the noiseless block portion. The third term,<italic>p</italic>
          <sub>&#10;<italic>r</italic>&#10;</sub>=<italic>pE</italic>(<italic>N</italic>−<italic>E</italic>+<italic>pE</italic>) (<italic>E</italic>edge number) gives the probability of selecting links in the random distribution of removed ones. The probability of an inter-block link is&#10;</p>
        <disp-formula code="" id="eqn7">
        </disp-formula>
        <p>&#10;where the numerator takes into account the amount of removed links, while the denominator regards the possible matrix entries where those links can be placed. For further details regarding the network generation model we refer the reader to<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>.</p>
      </sec>
      <sec>
        <title level="2">Empirical datasets</title>
        <p>To explore our hypothesis in real scenarios, we perform experiments on 192 bipartite ecological networks from two papers and two online databases: 35 trophic networks from<sup>
            <xref ref-type="bibr" rid="c68">68</xref>,<xref ref-type="bibr" rid="c69">69</xref>
          </sup>, 141 mutualistic networks from the Web of Life dataset<sup>&#10;<xref ref-type="bibr" rid="c70">70</xref>&#10;</sup>, and 16 (3 mutualistic and 13 trophic) networks from the Interaction Web Database<ext-link xlink:href="http://www.ecologia.ib.usp.br/iwdb">http://www.ecologia.ib.usp.br/iwdb</ext-link>hosted by the National Center for Ecological Analysis and Synthesis (University of California). All the networks in our dataset were treated as binary (unweighted links) and we have only kept in our study networks with a minimum of 20 nodes, to ensure that the identified architectural patterns are well defined. In parallel, to reduce computational costs we restricted our analysis to networks below 300 nodes. We highlight, however, that the number of nodes in most of the networks lie between this range, values above or below can be considered outliers, see<ext-link xlink:href="#s3c">Section 3.3</ext-link>below.</p>
      </sec>
      <sec>
        <title level="2">Null Models</title>
        <p>The appropriate selection of a null model has been a center of debate in the ecology literature for many decades. The first attempts to estimate the significance of structural patterns in ecological networks date back to the 70s<sup>
            <xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref>
          </sup>. In this context, scholars introduced approaches relying on the generation of random networks, either by keeping fixed the number of rows (or columns) nodes degrees and allowing the number of columns (or rows) nodes degrees to change<sup>&#10;<xref ref-type="bibr" rid="c23">23</xref>&#10;</sup>; or by generating networks that exactly preserved degrees of both guilds<sup>&#10;<xref ref-type="bibr" rid="c24">24</xref>&#10;</sup>. Afterward, models that preserves, on average, nodes degrees in both guilds were also introduced<sup>
            <xref ref-type="bibr" rid="c71">71</xref>,<xref ref-type="bibr" rid="c1">1</xref>
          </sup>. More recently, models based on constructing maximum-entropy ensembles of networks with an expected degree sequence were also exploited to assess statistical significance<sup>
            <xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c72">72</xref>
          </sup>.</p>
        <p>In Gotelli<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c22">22</xref>&#10;</sup>, the authors considered three basic constraints that can be imposed independently for rows or columns nodes: 1) where the individual nodes’ degrees are exactly preserved, namely<italic>fixed</italic>(F), 2) where the nodes’ degrees are preserved on average, i.e., the probability of interaction is<italic>proportional</italic>(P) to the degree, and 3) where all the pairwise interactions between nodes are<italic>equally probable</italic>(E). Resulting in a total of 32 = 9 possible null models, each one having multiple possible implementations.</p>
        <p>Below, we provide details for these three basic classes of null models and describe some of the implementations for each case, with special attention to those that were employed in the present work. It worth highlighting that in all of our implementations, the corresponding constraints were applied for both rows and columns nodes. Therefore, we will talk about EE, FF, and PP models, according the nomenclature employed in<sup>&#10;<xref ref-type="bibr" rid="c16">16</xref>&#10;</sup>.</p>
        <sec>
          <title level="3">Equiprobable-Column or Equiprobable-Row (EE) model</title>
          <p>The least constrained scheme reviewed here, EE is a probabilistic binary null model that assumes that all the interactions between pairs of nodes –row-to-column links– are equally probable, and that such connection is given with probability<inline-formula code="">
            </inline-formula>, where<italic>L</italic>is the total number of connections in the original matrix. This model generates Erdös-Rényi networks with nodes exhibiting a varying number of connections around a well-defined average degree ⟨<italic>k</italic>⟩, preserving<italic>L</italic>on average. It is known for its tendency to falsely detect significant nested patterns,<italic>i</italic>.<italic>e</italic>., it is prone to type I statistical errors<sup>
              <xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c73">73</xref>,<xref ref-type="bibr" rid="c20">20</xref>
            </sup>.</p>
        </sec>
        <sec>
          <title level="3">Fixed-Column Fixed-Row (FF) models</title>
          <p>In the other extreme of the spectrum<sup>&#10;<xref ref-type="bibr" rid="c74">74</xref>&#10;</sup>, the FF model enforces row-nodes’ and column-nodes’ degrees to be strictly preserved. It is thus the most restrictive null model. The usage of this type of model to assess the probability that an observed pattern could be explained by chance alone has been applied since the 70s<sup>&#10;<xref ref-type="bibr" rid="c24">24</xref>&#10;</sup>. A typical way for generating random matrices under this constraint is through the application of some form of swap algorithm, performing exchanges between pairs of interacting nodes without altering the network’s degree sequence<sup>&#10;<xref ref-type="bibr" rid="c22">22</xref>&#10;</sup>.</p>
          <p>Noteworthy, generating random matrices by exactly preserving the degrees is far from being a trivial task. Swap methods tend to generate repeated matrices that closely resemble the original network. Thus, in order to produce a truly representative set of matrices within the universe of possible matrix configurations, a very large number of matrices need be generated<sup>&#10;<xref ref-type="bibr" rid="c75">75</xref>&#10;</sup>, which might not be possible in some scenarios. As a consequence, this model is susceptible to type II errors, particularly, when it comes to the assessment of nested patterns<sup>
              <xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c73">73</xref>
            </sup>. On the other hand, it also tends to generate matrices with more checkerboard units<sup>&#10;<xref ref-type="bibr" rid="c2">2</xref>&#10;</sup>than expected by chance<sup>&#10;<xref ref-type="bibr" rid="c25">25</xref>&#10;</sup>, producing a biased sample. To solve the latter downside, scholars have introduced variations of the swap methods, and alternative methods that are able to generate a uniform sample of null matrices with fixed row and column degrees<sup>
              <xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref>
            </sup>.</p>
          <p>In this work, we employ the Curveball algorithm, introduced in<sup>&#10;<xref ref-type="bibr" rid="c26">26</xref>&#10;</sup>as an FF model, as a fast and efficient alternative to generate random matrices with fixed nodes’ degrees guaranteeing a uniform sample<sup>&#10;<xref ref-type="bibr" rid="c76">76</xref>&#10;</sup>. The algorithm was introduced as a computationally cheap method to perform permutations on binary matrices, producing uniformly distributed random matrices with fixed degrees. The functioning of the algorithm goes as follows: starting from a binary bipartite matrix –<italic>e</italic>.<italic>g</italic>., representing species per site or plant-pollinator matrices, in the ecological context–, for each row (column) node, a list is created containing all the column (row) indices with nonzero elements. Then, the algorithm iteratively chooses at random two row lists (columns), identifies the column (row) indices that are present in list, but not in the other, and vice-versa, and performs random “trades” of the column (row) indices. The number of trades for each pair of lists will go from zero to the size of the smallest list of column indices. In this work, we resort to the Python implementation of the algorithm that was provided by the authors in<sup>&#10;<xref ref-type="bibr" rid="c26">26</xref>&#10;</sup>.</p>
        </sec>
        <sec>
          <title level="3">Row-Proportional Column-Proportional (PP) models</title>
          <p>Somewhere between the extremes –and limitations– described above<sup>&#10;<xref ref-type="bibr" rid="c74">74</xref>&#10;</sup>, an intermediate alternative is to generate models that preserve degrees on average, mitigating then, the proneness to type II error that is present in the FF models, and the proneness to type I error present in the EE model. For this type of model, the probability of interaction of a pair of nodes is assigned to be proportional to the nodes’ degrees. From this general principle, there exist different flavors along the loose-strict continuum. Below we introduce three variants employed here.</p>
          <sec>
            <title level="4">Bascompte’s probabilistic model</title>
            <p>One of the most popular probabilistic models for the assessment of statistically significant structural patterns (particularly nested ones) was introduced by Bascompte<italic>et al</italic>. in 2003<sup>&#10;<xref ref-type="bibr" rid="c1">1</xref>&#10;</sup>. In this model, the probability of an interaction by a pair of nodes is proportional to the nodes’ degrees of the original matrix as:&#10;</p>
            <disp-formula code="" id="eqn8">
            </disp-formula>
            <p>&#10;where<italic>k</italic>
              <sub>&#10;<italic>i</italic>&#10;</sub>is the degree of the i−th row,<italic>k</italic>
              <sub>j</sub>is the degree of the j−th column and<italic>N</italic>
              <sub>&#10;<italic>r</italic>&#10;</sub>and<italic>N</italic>
              <sub>&#10;<italic>c</italic>&#10;</sub>are the respective number of rows and columns nodes.</p>
          </sec>
          <sec>
            <title level="4">Maximum-entropy exponential random graphs</title>
            <p>Introduced in the last decade<sup>&#10;<xref ref-type="bibr" rid="c77">77</xref>&#10;</sup>, this is a statistical physics framework that facilitates the analytic computation of the expected properties of an ensemble of networks. Under this formulation, the expected values and standard deviation of the network properties are calculated by finding a probability distribution over an ensemble of networks –which, on average preserve the network’s degree sequence–, that maximizes the entropy of the network. This approach can be applied to both uni- and bipartite networks, and has been recently exploited to assess the significance of nestedness structural arrangements in economic<sup>&#10;<xref ref-type="bibr" rid="c78">78</xref>&#10;</sup>, and ecological<sup>&#10;<xref ref-type="bibr" rid="c72">72</xref>&#10;</sup>networks.</p>
            <p>With this approach, one aims to find a probability distribution<italic>P</italic>(<italic>G</italic>) over the ensemble of graphs<italic>G</italic>, with<italic>G</italic>* as the graph corresponding to the real network, that maximizes the Shannon-Gibbs entropy<italic>S</italic>= Σ<sub>&#10;<italic>G</italic>&#10;</sub>−<italic>P</italic>(<italic>G</italic>) ln<italic>P</italic>(<italic>G</italic>), and that keeps the average nodes’ degree fixed. This maximization has a solution given by the canonical distribution&#10;</p>
            <disp-formula code="" id="eqn9">
            </disp-formula>
            <p>&#10;where<italic>Z</italic>is the partition function,<italic>H</italic>(<italic>G, θ</italic>) =<italic>θ</italic>
              <bold>&#10;<italic>C</italic>&#10;</bold>(<italic>G</italic>) is the graph Hamiltonian, and<italic>θ</italic>is a vector of Lagrange multipliers resulting from the maximization of the Shannon-Gibbs entropy, under the chosen constraints<bold>&#10;<italic>C</italic>&#10;</bold>, e.g., the graph’s average degree. The next step consists on the calculation of the exact values of the Lagrange multipliers. Following the approach presented in<sup>&#10;<xref ref-type="bibr" rid="c77">77</xref>&#10;</sup>, these multipliers are determined by imposing that the chosen constraints of the network are found in the ensemble with maximum probability. This is achieved by rewriting the log-likelihood of observing the real network as<italic>L</italic>(<italic>&#10;<bold>θ</bold>&#10;</italic>) = −<italic>H</italic>(<italic>G</italic>*,<italic>&#10;<bold>θ</bold>&#10;</italic>) − ln<italic>Z</italic>(<italic>θ</italic>) and maximizing this quantity in order to find the optimal variables<italic>θ</italic>
              <bold>&#10;<italic>*</italic>&#10;</bold>that define the ensemble. Once the parameters<bold>&#10;<italic>θ*</italic>&#10;</bold>are found, it is possible to build the matrix containing the average probability of interaction corresponding to our empirical network ⟨<italic>G</italic>*⟩. Finally, it is possible to derive an analytical expression of the first and second moments of the desired network property. In this work, instead of analytically deriving such statistical properties, we will generate a random ensemble directly from the matrix of average probabilities of interactions.</p>
          </sec>
          <sec>
            <title level="4">Corrected Probabilistic Model</title>
            <p>Lastly, we now introduce an alternative PP variant that aims to mitigate the possible weaknesses of the models described above. The corrected probabilistic model, in the same spirit as Bascompte’s one, sets the probability of interaction by a pair of nodes to be proportional to the nodes’ degrees of the observed matrix, but includes two corrections terms. These terms help to reduce the discrepancies observed in the probabilistic model at preserving the nodes’ degrees –on average–, while avoiding the production of network instances that are too similar to the original matrix, as in the Maximum-entropy model. In this work, we will test in depth the robustness of this model against type I and type II errors. Overall, in this model, the threshold ruling the existence of a link is given by:&#10;</p>
            <disp-formula code="" id="eqn10">
            </disp-formula>
            <p>&#10;where<italic>k</italic>
              <sub>&#10;<italic>i</italic>&#10;</sub>is the degree of the<italic>i</italic>−th row,<italic>k</italic>
              <sub>&#10;<italic>j</italic>&#10;</sub>is the degree of the<italic>j</italic>−th column, ⟨<italic>k</italic>
              <sup>&#10;<italic>r</italic>&#10;</sup>⟩ and ⟨<italic>k</italic>
              <sup>&#10;<italic>c</italic>&#10;</sup>⟩ are the row and column average degrees, and<italic>N</italic>
              <sub>&#10;<italic>r</italic>&#10;</sub>and<italic>N</italic>
              <sub>&#10;<italic>c</italic>&#10;</sub>are the respective number of rows and columns nodes. The quantity is the sum of the term in<ext-link xlink:href="#eqn8">equation (8)</ext-link>and a correction term taking into account the probability that links can appear in a row (column) also by sampling over the columns (rows). Specifically, the degree of a given row node is obtained by sampling over this axis (something which is correctly described by<ext-link xlink:href="#eqn8">Equation (8)</ext-link>), or by sampling over columns: this information is embodied in the term within the square brackets proportional to<italic>k</italic>
              <sub>&#10;<italic>j</italic>&#10;</sub>
              <italic>/N</italic>
              <sub>&#10;<italic>r</italic>&#10;</sub>In this latter case, one has to taken into account the probability that a links already exists because of the first sampling process, and this justifies the term proportional to ⟨<italic>k</italic>⟩ Of course, the final expression is symmetrical for row-column permutation.</p>
          </sec>
        </sec>
      </sec>
    </sec>
    <sec sec-type="Results">
      <title level="1">RESULTS</title>
      <p>In the following, we present the results concerning the test of the five null model classes against the three architectural patterns of interest. For a systematic exploration,<ext-link xlink:href="#s3a">Sections 3.1</ext-link>and<ext-link xlink:href="#s3b">3.2</ext-link>exploit the synthetic generative model introduced in<ext-link xlink:href="#s2b">Sec. 2.2</ext-link>. With it, the construction of nested matrices is performed by keeping fixed the number of blocks (<italic>B</italic>= 1) and varying values of<italic>ξ</italic>and<italic>p</italic>, as in the top row of<ext-link xlink:href="#fig2">Fig. 2</ext-link>. For the set of purely modular networks, we fixed<italic>ξ</italic>= 1.5 and<italic>p</italic>= 1 and smoothly modified<italic>B</italic>and<italic>μ</italic>to cover a wide range of modularity values,<italic>e</italic>.<italic>g</italic>. second row of<ext-link xlink:href="#fig2">Fig. 2</ext-link>. Finally, the generation of in-block nested networks was carried out setting<italic>B</italic>= 4,<italic>ξ</italic>= 1.5 and varying levels of<italic>p</italic>and<italic>μ, e</italic>.<italic>g</italic>. third row of<ext-link xlink:href="#fig2">Fig. 2</ext-link>. At the end of the process, we generated around 9000 networks for each one of the three patterns of interest,<italic>i</italic>.<italic>e</italic>., ∼ 2.5 × 104 in total. For each generated network, we created 100 random surrogates with each null model. The number of rows and columns were varied within the range [30, 60]. Finally, in<ext-link xlink:href="#s3c">Section 3.3</ext-link>, we perform the statistical significance test on a large collection of empirical networks.</p>
      <sec>
        <title level="2">Resemblance of original<italic>vs</italic>. randomized networks</title>
        <p>To understand the implications of each null model approach, we analyze in detail how a synthetic network resembles those of the corresponding null model ensembles. To do so, we first look into the node degrees of a particular matrix, and then perform a comparison over the space of parameters introduced in<ext-link xlink:href="#s2b">Sec. 2.2</ext-link>by recalling the Jaccard distance.</p>
        <p>
          <ext-link xlink:href="#fig4">Figure 4</ext-link>analyzes in detail the properties of the ensemble obtained with the three PP models for a given network with planted nested structure (large matrix on the left). Examples for other types of matrices are available in Fig. S1 of the supplementary material. The top row represents the resulting matrices of interaction probability as a heatmap. Even visually, it is clear how permissive –or strict– each model is with respect to the original network. More in detail, the bottom row presents a scatter plot of the degree sequence of the original matrix against those of the resulting null matrices sets (in average). The error bars correspond to one standard deviation above and below the obtained average degrees. Herein, we observe that the probabilistic model appears to be too permissive, failing to preserve –even on average– the nodes’ original degree. The max-entropy scheme almost exactly preserves the average degree sequences, hence, it might solve the proneness to type I errors that are present in the probabilistic model. The corrected probabilistic model presents a good agreement, with slight deviations for extreme (smallest and largest) degrees. Noteworthy, EE and FF models are not included in this figure –their scatter plots would render a trivial picture.</p>
        <fig id="fig4">
          <label>4</label>
          <caption>
            <p>Comparison between a synthetic network (left) with planted nested structure, and their corresponding matrices of interaction probabilities<italic>p</italic>
              <sub>&#10;<italic>ij</italic>&#10;</sub>(top right row) produced by the three<bold>PP</bold>models: maximum-entropy, Probabilistic and Corrected Probabilistic, respectively, and the scatter plots showing the fit between the obtained average degree sequences with each model and the real degrees of the matrix (bottom right row). Error bars in the scatter plots indicate one standard deviation above and below the average. The same comparisons between the three models for matrices with planted modular and in-block nested structures are available in Fig. S1 of the supplementary material.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig4">
          </inline-graphic>
        </fig>
        <p>For a wider look at the ensemble of null matrices, we now consider the parameter space of the network benchmark. Concretely, e explore to what extent the generated null matrices resemble the original synthetic ones for the whole range of parameters of he graph model. To quantify such resemblance, we employ the Jaccard distance<bold>&#10;<italic>J</italic>&#10;</bold>
          <sub>&#10;<italic>d</italic>&#10;</sub>, which accounts for the level of dissimilarity between two binary arrays –the original and its random counterparts, in this case. It should be noted that, in the case of binary arrays,<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>= 0 indicates that the matrices are identical.</p>
        <p>Top row in<ext-link xlink:href="#fig5">Fig. 5</ext-link>shows the average Jaccard distance ⟨<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>⟩ over the nested<italic>ξ</italic>−p parameter space for each null model scheme. Similar results for the modular and in-block nested matrices are shown in Fig. S2 of the supplementary material. As expected, the results for the EE and the probabilistic models show high values of the ⟨<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>⟩ over the entire<italic>ξ</italic>−p parameter space, confirming that the randomized matrices generated by these models are substantially different from the original one. Turning to the FF and Max-entropy models, we observe a wide region of the<italic>ξ</italic>− p parameter space in which ⟨<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>⟩ drops to intermediate and low values –specially for networks with small noise<italic>p</italic>, regardless of the slimness of the nested structure<italic>ξ</italic>These results for FF and Max-entropy confirm that, at least for nested networks, the resulting null matrices are very similar to the original one, since the models only allow for a very little deviation on the degree sequences –none in the FF model. Hence, these models might easily fall into type II errors. The corrected probabilistic model, instead, provides a good trade-off, offering a better fit of the degree sequences, while generating null matrices less similar to the original one, as evinced by the overall intermediate values of the ⟨<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>⟩ over the nested<italic>ξ</italic>− p parameter space.</p>
        <fig id="fig5">
          <label>5</label>
          <caption>
            <p>
              <bold>Synthetic nested Networks:</bold>2 − dimensional plot in the<italic>ξ</italic>−<italic>p</italic>parameter space showing: the average Jaccard distance ⟨<italic>J</italic>
              <sub>&#10;<italic>d</italic>&#10;</sub>⟩ with of the null model ensembles with respect to the original nested synthetic matrix (top panel), and the % of matrices in he null model ensembles for which the Jaccard distance with respect to the original synthetic matrix was above a threshold of<italic>J</italic>
              <sub>&#10;<italic>d</italic>&#10;</sub>≥0.4 (bottom panel), for the five models studied in this work.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig5">
          </inline-graphic>
        </fig>
        <p>From another perspective, the bottom panel of<ext-link xlink:href="#fig5">Fig. 5</ext-link>shows the percentage of matrices in the null model ensembles for which<italic>J</italic>
          <sub>&#10;<italic>d</italic>&#10;</sub>≥ 0.4 in the nested<italic>ξ</italic>− p parameter space. Clearly, there are relevant regions for which the FF and the Max-entropy models cannot generate true variants of the original matrix, even with such moderate threshold. Of course, when imposing a more rigid threshold this region becomes wider. In the other extreme, the EE and Probabilistic schemes prove to have ample room to generate largely different networks, no matter the parameter values under study. Somewhere in between, the Corrected Probabilistic model is flexible enough to produce different networks, except in some extreme cases (very sparse networks with low<italic>p</italic>). These insights are all in good agreement with a recent work developed by Strona<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c74">74</xref>&#10;</sup>, in which they proved that slightly relaxing the restrictiveness in the preservation of the rows and column totals –quasi-FF matrices– can reduce the tendency to underestimate significant nestedness.</p>
      </sec>
      <sec>
        <title level="2">Statistical significance of structural patterns</title>
        <p>We now analyze how consistent the five null models described above are in assessing the statistical significance of nested, modular and in-block nested patterns, for each set of the generated synthetic matrices (192 empirical ecological networks are analyzed in the next section). In each case, we assessed the significance of the three patterns of interest. The results of the analysis are summarized in<ext-link xlink:href="#tbl1">Table 1</ext-link>, which accounts the % of networks with<italic>z</italic>≥2,<italic>i.e</italic>., an associated<italic>p</italic>-value around 0.025. For nested networks, we also explore the behavior of the null models under other nestedness metric<underline>s</underline>: NODF<sup>&#10;<xref ref-type="bibr" rid="c54">54</xref>&#10;</sup>and the spectral radius<inline-formula code="">
          </inline-formula>
          <sup>
            <xref ref-type="bibr" rid="c51">51</xref>,<xref ref-type="bibr" rid="c11">11</xref>
          </sup>normalized with respect to the square root of the number of links in the matrices,<inline-formula code="">
          </inline-formula>, as in<sup>&#10;<xref ref-type="bibr" rid="c32">32</xref>&#10;</sup>.</p>
        <table-wrap id="tbl1">
          <label>1</label>
          <caption>
            <p>Percentage % of networks with z 2 for three sets of synthetic networks with nested, modular and in-block nested structure. The over and underestimation values mentioned in the text are marked in red and blue, respectively.</p>
          </caption>
          <table>
          </table>
        </table-wrap>
        <p>For networks with planted nested structure (B = 1, p E [0, 0.5]), the EE and Probabilistic models overestimate systematically he statistical significance for nestedness –no matter the metric. In the other extreme, both the FF and Max-entropy restrictive schemes deliver an underestimation of the amount of truly nested networks. Thus, confirming their proneness to type I and II errors, respectively. Only the corrected probabilistic model renders a balanced assessment, consistent with the parameters used in the generation of this set of nested synthetic matrices. The assessment of the significance for in-block nestedness is generally consistent with the one observed for nestedness, as ℐ reduces to ℐ when<italic>B</italic>= 1 (recall<ext-link xlink:href="#eqn2">Eqs. 2</ext-link>and<ext-link xlink:href="#eqn4">4</ext-link>).</p>
        <p>More intriguingly, the FF and Max-entropy models identify a large fraction of nested-by-construction networks as being significantly modular (24.2% and 46.37%, respectively). To some extent, this could be explained by the densest nested matrices in the collection<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>,<italic>i.e</italic>., low i;, but by no means the collection should be regarded, overall, to be more modular than nested.</p>
        <p>Turning to modular-by-construction networks (<italic>B</italic>&gt; 1, p = 1,<italic>μ</italic>∈ [0, 0.5]), we observe that –unlike the previous case– all models render intuitively correct results: these networks are unanimously assessed as non-nested, mostly assessed as modular (except for those with high<italic>μ</italic>), and around half of the collection is assessed as being in-block nested, which makes sense considering configurations with low<italic>p</italic>(which are modular<italic>and</italic>in-block nested).</p>
        <p>Finally, networks with planted in-block nestedness (B = 4, p ∈ [0, 0.5], μ ∈ [0, 0.5]) again arise inconsistencies among the randomization procedures. Some of them (EE, FF and Probabilistic) incorrectly assess a large amount of networks as being nested –this is particularly marked in the case of EE.</p>
        <p>Considering the results in<ext-link xlink:href="#tbl1">Table 1</ext-link>, it is clear that nested structures are the most confusing given the outcomes of the different randomization schemes. For this reason, we explore these inconsistencies in further detail in<ext-link xlink:href="#fig6">Figure 6</ext-link>regarding only the nested- by-construction synthetic subset. The figure shows the<italic>z</italic>-score values for nestedness<italic>z</italic>
          <sub>..<italic>N</italic>
          </sub>(top) and modularity<italic>z</italic>
          <sub>&#10;<italic>Q</italic>&#10;</sub>(bottom) over the<italic>ξ</italic>−<italic>p</italic>parameter space of the generated nested matrices, considering the three PP models. Thumbnails of the resulting generated matrices over the parameter space are shown on the left part of the figure as a visual aid.</p>
        <fig id="fig6">
          <label>6</label>
          <caption>
            <p>
              <bold>Synthetic Nested Networks:</bold>Heatmaps in the<italic>ξ</italic>−<italic>p</italic>parameter plane showing:<italic>z</italic>
              <sub>&#10;<italic>𝒩</italic>&#10;</sub>(top) and<italic>z</italic>
              <sub>&#10;<italic>Q</italic>&#10;</sub>(bottom) scores values under the Max-entropy, probabilistic, and corrected probabilistic models for the set of ∼9000 synthetic bipartite networks with planted nested structure. Examples of the resulting generated matrices over the parameter space are shown on the left part of the figure.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig6">
          </inline-graphic>
        </fig>
        <p>The results of<ext-link xlink:href="#fig6">Fig. 6</ext-link>for the probabilistic model confirm the tendency for overestimating the statistical significance of nested patterns,<italic>i.e</italic>., type I error. The model yields values of<italic>z</italic>
          <sub>𝒩</sub>≥2 over the whole parameter space, including the regions where the planted nested structure becomes hardly identifiable (high<italic>p</italic>). The Max-entropy model, conversely, is not able to assess the significance of nestedness, even in regions where the networks have a clearly defined nested pattern, except for those networks with high<italic>ξ</italic>The corrected probabilistic model is capable of assessing the significance of the nested pattern over a wide region of the parameter space, for intermediate to low values of noise<italic>p</italic>–as expected–, and different shape values<italic>ξ</italic>. Note, however, that the higher the value of<italic>ξ</italic>is, less noise<italic>p</italic>is necessary for the model to reach<italic>z</italic>
          <sub>𝒩</sub>≤2. This is not surprising, since the<italic>ξ</italic>parameter affects the network connectance, and sparser networks will require a lower level of noise to distort the planted nested structure. For the sake of completeness, Fig. S3 in the supplementary material shows the results for NODF and,<inline-formula code="">
          </inline-formula>showing equivalent results, in spite of the different nature of the two metrics. The assessment of significance for modularity<italic>z</italic>
          <sub>&#10;<italic>Q</italic>&#10;</sub>with the probabilistic and corrected probabilistic models shows small regions of z<sub>Q</sub>≥2 that corresponds to high connectance networks (low<italic>ξ</italic>). In these cases, one can assume that networks are dense enough, such that the optimization algorithm employed for modularity is able to find a partition with<italic>B</italic>&gt; 1, resulting in values of<italic>Q</italic>larger than expected<sup>&#10;<xref ref-type="bibr" rid="c38">38</xref>&#10;</sup>. The Max-entropy model, however, assesses significance for modular patterns over a wide region of the<italic>ξ</italic>− p parameter space –around 46% of the networks in<ext-link xlink:href="#tbl1">Table 1</ext-link>–, strengthening our assumptions regarding the presence of biases towards an overestimation of statistical significance of modular patterns.</p>
        <p>Moving on, we know discuss the results for the set of synthetic matrices with modular structure. From<ext-link xlink:href="#tbl1">Table 1</ext-link>, we can observe that the assessment of significance for nestedness across this set of matrices yields coherent results for the five models. We obtained values of<italic>z</italic>
          <sub>𝒩</sub>≤2 consistently throughout the whole set. Such result is not surprising, since by construction, all the networks present a clearly modular planted structure, and as mentioned above, we have evidence that these two patterns may not be structurally compatible<sup>&#10;<xref ref-type="bibr" rid="c65">65</xref>&#10;</sup>. Results for the assessment of modularity and in-block nestedness from<ext-link xlink:href="#tbl2">Table 2</ext-link>are complemented with<ext-link xlink:href="#fig7">Figure 7</ext-link>. The figure shows the z-score values for modularity<italic>z</italic>
          <sub>&#10;<italic>Q</italic>&#10;</sub>(top) and in-block nestedness<italic>z</italic>
          <sub>&#10;<italic>ℐ</italic>&#10;</sub>(bottom) over the<italic>μ</italic>−<italic>B</italic>parameter space of the generated matrices, with the three PP models. Similarly to<ext-link xlink:href="#fig6">Fig. 6</ext-link>, examples of the resulting matrices over the parameter space are shown on the left part of the figure. Again,<ext-link xlink:href="#tbl1">Table 1</ext-link>reports an unanimous assessment of modularity across the five models. Top panel in<ext-link xlink:href="#fig7">Fig.7</ext-link>for the PP models confirms these results: the models are able to assess the significance of modularity for a wide range of the parameter space. As expected, the assessment is sensitive to level inter-block noise<italic>μ</italic>. Although, the Max-entropy model is still able to assess the significance for modularity in regions with high<italic>μ</italic>values, where the planted modular structure is hardly identifiable anymore. Results for the assessment of in-block nestedness also show consistent results across the five models (see<ext-link xlink:href="#tbl1">Table 1</ext-link>). For around half of the networks in this set, we obtain a significant level of in-block nestedness. Again, the critical ingredient here is the presence of inter-block noise μ. The result is in agreement with Palazzi<italic>et al</italic>.<sup>&#10;<xref ref-type="bibr" rid="c65">65</xref>&#10;</sup>, in which it is proved that both<italic>Q</italic>and ℐ can coexist, as there are no mutually imposed constraints between them.</p>
        <table-wrap id="tbl2">
          <label>2</label>
          <caption>
            <p>Percentage of networks with score z 2 for a collection of 192 empirical ecological networks.</p>
          </caption>
          <table>
          </table>
        </table-wrap>
        <fig id="fig7">
          <label>7</label>
          <caption>
            <p>
              <bold>Synthetic Modular Networks:</bold>Heatmaps in the<italic>μ</italic>−<italic>B</italic>parameter plane showing:<italic>z</italic>
              <sub>&#10;<italic>Q</italic>&#10;</sub>(top) and<italic>z</italic>
              <sub>ℐ</sub>(bottom) scores values under the Max-entropy, probabilistic, and corrected probabilistic models for the set of ∼9000 synthetic bipartite networks with modular structure. Examples of the resulting generated matrices over the parameter space are shown on the left part of the figure.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig7">
          </inline-graphic>
        </fig>
        <fig id="fig8">
          <label>8</label>
          <caption>
            <p>
              <bold>Synthetic in-block nested Networks:</bold>Heatmaps in the<italic>μ</italic>−<italic>p</italic>parameter plane showing:<italic>z</italic>
              <sub>&#10;<italic>ℐ</italic>&#10;</sub>(top) and<italic>z</italic>
              <sub>&#10;<italic>𝒩</italic>&#10;</sub>(bottom) scores values under the Max-entropy, probabilistic, and corrected probabilistic models for the set of ∼9000 synthetic bipartite networks with in-block nested structure. Examples of the resulting generated matrices over the parameter space are shown on the left part of the figure.</p>
          </caption>
          <inline-graphic xlink:href="465267v1_fig8">
          </inline-graphic>
        </fig>
        <p>Finally, we move on to examine the results for the last set of synthetic networks, with planted in-block nested structure. igure 8 complements the results for this set of networks in<ext-link xlink:href="#tbl1">Table 1</ext-link>, by showing the<italic>z</italic>-score values for in-block nestedness<italic>z</italic>
          <sub>&#10;<italic>ℐ</italic>&#10;</sub>(top) and nestedness<italic>z</italic>
          <sub>𝒩</sub>(bottom). As in the previous cases, the left part of the figure shows examples of the generated matrices with the PP models over the<italic>μ</italic>−<italic>p</italic>parameter space. The three models illustrated here show similar (and expected) results for<italic>z</italic>
          <sub>&#10;<italic>ℐ</italic>&#10;</sub>: in-block nestedness becomes less significant when the structure is distorted within (higher<italic>p</italic>) or among (higher<italic>μ</italic>) blocks. Such coherence contrasts with the assessment of significance for 𝒩, which deserve to be examined in more detail. It is known that global nestedness decreases with the number of blocks in a network, regardless of their internal nested structure<sup>&#10;<xref ref-type="bibr" rid="c65">65</xref>&#10;</sup>. Consequentially, the Max-entropy and Corrected probabilistic models correctly present non-significant<italic>z</italic>
          <sub>.𝒩</sub>&lt; 2 throughout the parameter plane, and even for low values of noise (either<italic>μ</italic>or<italic>p</italic>). Instead, the probabilistic scheme identifies as nested those matrices for which<italic>p</italic>&lt; 0.2, regardless of<italic>μ</italic>, a clear overestimation of nested patterns which occurs, even at higher proportions, in the EE and FF models (see<ext-link xlink:href="#tbl1">Table 1</ext-link>).</p>
      </sec>
      <sec>
        <title level="2">Empirical Networks</title>
        <p>Lastly, we also analyze how consistent the five null models are in assessing the statistical significance of nested, modular, and in-block nested patterns over a set of 192 empirical networks. All networks are treated as binary, and that only networks between 20 and 300 nodes are kept (see Section S2 and Figure S4 in the supplementary material for details). For the sake of consistency and completeness, we explore the behavior of the null models under the three nestedness metrics: 𝒩, NODF, and<inline-formula code="">
          </inline-formula>. We report the percentage of networks with<italic>z</italic>≥2 (<italic>p</italic>-value ∼ 0.025) for each one of our five structural metrics in<ext-link xlink:href="#tbl2">Table 2</ext-link>.</p>
        <p>Assessment of nestedness in the empirical data for the EE and Probabilistic models is consistent across the three different metrics, yielding<italic>z</italic>-score values<italic>z</italic>2 for a large proportion of the analyzed networks. The assessment of significance for in- block nestedness renders equivalent results, showing significant<italic>z</italic>
          <sub>&#10;<italic>ℐ</italic>&#10;</sub>≥ for a high percentage of the networks, although in a lower proportion with respect to nestedness. In contrast, only a small fraction of the networks is significantly modular (<italic>z</italic>
          <sub>
            <italic>Q</italic>≥</sub>2). Results for the strictest schemes –FF and Max-entropy models–, show, in the case of nestedness, a good agreement with the results in the synthetic matrices (and the literature<sup>&#10;<xref ref-type="bibr" rid="c72">72</xref>&#10;</sup>), yielding non-significant<italic>z</italic>-scores for a large majority of the networks. Note that, similar to the synthetic case, the normalized spectral radius<inline-formula code="">
          </inline-formula>, with the FF model is able to assess nestedness for a bigger proportionof the networks. Once again, the corrected probabilistic model seems to provide a more balanced assessment of nested patterns over the different metrics. The small variations in the preservation of the node’s degrees in the corrected probabilistic model allow nestedness to reemerge as significant in a small proportion of the networks.</p>
        <p>Moving on, results for modularity in the FF and Max-entropy model render inconsistent results, suggesting once again the esence of biases in the Max-entropy model with regard to the assessment of modular patterns. Finally, we observe that a elevant fraction of the networks exhibit significant in-block nestedness structure even with the most restrictive algorithms, in close agreement with recent studies suggesting the presence of in-block nestedness as a frequent pattern in ecological communities<sup>
            <xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c39">39</xref>
          </sup>.</p>
      </sec>
    </sec>
    <sec sec-type="Discussion">
      <title level="1">DISCUSSION</title>
      <p>The overwhelming evidence that real ecological networks are highly structured, rather than randomly assembled, has sparked much research to explain the emergence and dynamical effects of those interaction patterns. In parallel, efforts have been devoted at determining the statistical significance of such patterns. As a result, the use and design of specialized null models to assess the statistical significance of selected architectures has become a widespread approach within the ecological community. However, to this day, there is still no agreement on which is the most suitable procedure to perform this kind of analysis. The discussion regarding the selection on the level of constraints to build the null matrices, the construction of synthetic benchmarks, or the appropriate null model-metric combination remains an open issue among scholars. Furthermore, there is already abundant evidence suggesting that networks often exhibit hybrid structures and/or at different scales of organization, yet the concurrent assessment of the statistical significance of such complex patterns has not been extensively studied.</p>
      <p>In this work, we have first addressed the need to build synthetic networks with total control over their dominant structure. Our generative benchmark allows for the construction of networks with clear defined architectural patterns, transitioning from structured (nested, modular, in-block nested) to random networks in a smooth way. Only then we can generate a rich sample to systematically study of the performance of five popular null models.</p>
      <p>With over 25000 networks of varying size, connectance and internal structure, we have observed the existence of ambiguities and biases in the concurrent assessment of network patterns, either over- or underestimating their significance. In particular, our use of an extensive ensemble of networks uncovers the weaknesses of both too restrictive (FF, Max-entropy) and too permissive (EE, Probabilistic) randomizing procedures. At the face of such results, we propose a variation of the Probabilistic model, that mitigates some of the limitations exhibited by the current models –in close agreement with recent research, regarding the convenience of quasi-FF approaches<sup>&#10;<xref ref-type="bibr" rid="c74">74</xref>&#10;</sup>. Last but not least, our results on empirical networks show an overall good agreement with the results obtained on the synthetic matrices. Indeed, we observe again the presence of ambiguities in the simultaneous assessment of the patterns across models, with the corrected probabilistic model standing out as a reliable alternative to assess the significance of highly structured matrices.</p>
      <p>We are convinced that our results can orient the future debate regarding the use of null models in bipartite networks within and beyond the ecological community. Providing a compact framework and off-the-shelf implementations (synthetic benchmark, structural descriptors, optimization algorithms, and null models), our aim is double: on the theoretical side, to continue the research on the underlying assumptions and implicit consequences of the different null models. For example, to discern the apparent bias of the Max-entropy model towards underestimating the presence of nested configurations, while overestimating the presence of modular ones. On the practical side, to encourage researchers to shift the focus towards the simultaneous assessment of the statistical significance of multiple structural patterns at multiple scales –especially given the increasing evidence that empirical systems may display structure at several scales of organization, and frequently in the form of compound structures.</p>
    </sec>
    <sec sec-type="SupplementaryMaterials">
      <title level="1">Supporting information</title>
      <supplementary-material id="DC1" href="supplements/465267_file02.pdf">
        <label>material</label>
      </supplementary-material>
    </sec>
    <sec sec-type="CompetingInterests">
      <title level="1">Competing Interest Statement</title>
      <p>The authors have declared no competing interest.</p>
    </sec>
    <sec sec-type="CodeAvailability">
      <title level="1">CODE AVAILABILITY</title>
      <p>The corresponding software code to (1) generate synthetic networks with nested, modular and in-block nested structures; (2) the implementation of the metrics and optimization algorithms aimed to characterize nestedness, modularity, and in-block nestedness; and (3) the Python implementation of the five null models employed in this paper are available at the Github repository<ext-link xlink:href="https://github.com/COSIN3-UOC">https://github.com/COSIN3-UOC</ext-link>.</p>
    </sec>
    <sec sec-type="Acknowledgements">
      <title level="1">ACKNOWLEDGEMENTS</title>
      <p>M.J.P., A.S.-R. and J.B-H. acknowledge the support of the Spanish MICINN project PGC2018-096999-A-I00. M.J.P. acknowledges as well the support of a Postdoctoral research grant from the Universitat Oberta de Catalunya (UOC).</p>
    </sec>
  </body>
</article>
