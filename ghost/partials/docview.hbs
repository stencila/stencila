
<div class="container mx-auto px-2">
  <div class="relative flex">
    <div class="hidden lg:block absolute h-full top-0 left-0 -translate-x-full h-full w-screen bg-gray-50"></div>
    <!-- Mobile Menu Toggle -->
    <button class="fixed top-24 lg:top-36 left-8 flex items-center justify-center leading-none bg-brand-blue text-white p-3 w-12 h-12 rounded-full shadow-lg lg:hidden block" id="sidebar-toggle">
        <div class="gh-burger-box">
            <div class="gh-burger-inner"></div>
        </div>
    </button>
    <div id="sidebar" class="fixed flex-none bg-gray-50 lg:sticky top-20 pl-12 lg:pl-0 left-0 lg:top-32 h-[calc(100vh-5rem)] overflow-y-auto z-20">        
        <button id="sidebar-close" class="block absolute top-2 right-2 w-6 h-6 lg:hidden hover:text-gray-400">{{> icons/x }}</button>
        <aside class="w-64 pr-4 py-12 h-full border-r border-gray-200">
            {{#page}}
            <nav>
                <div class="mb-4">
                    <a href="/docview" class="text-lg font-semibold {{#match ../currentSlug "=" slug}}text-brand-blue{{else}}text-gray-800 hover:text-brand-blue{{/match}}">{{title}}</a>
                </div>
            </nav>
                {{#foreach tags}}
                    <h4 class="mb-4 font-bold">{{name}}</h4>
                    <ul class="ml-4 mb-8">
                        {{#get "posts" filter="tags:{{slug}}" limit="all" order="title asc"}}
                            <div 
                                id="menu" 
                                posts='[
                                    {{#foreach posts}}
                                        {
                                            "title": "{{title}}",
                                            "url": "{{url}}" 
                                        }{{#if @last}}{{else}},{{/if}}
                                    {{/foreach}}
                                ]
                                '
                            >
                            </div>
                            {{#foreach posts as |post|}}
                                <li class="mb-2">
                                    <a href="{{post.url}}" class="{{#match ../../../../currentSlug "=" post.slug}}text-brand-blue font-semibold{{else}}text-gray-700 hover:text-brand-blue{{/match}}">
                                        {{post.title}}
                                    </a>
                                </li>
                            {{/foreach}}
                        {{/get}}
                    </ul>
                {{/foreach}}
            {{/page}}
        </aside>
    </div>
        <div class="flex-auto">
            {{#post}}
            <article class="gh-article {{post_class}}">

                <header class="gh-header gh-canvas">
                    <span class="gh-post-meta"><time datetime="{{date format="YYYY-MM-DD"}}">{{date format="D MMM YYYY"}}</time> <span class="bull">&bull;</span> {{reading_time}}</span>
                    <h1 class=" text-3xl lg:text-5xl">{{title}}</h1>

                    {{#if custom_excerpt}}
                    <p class="gh-excerpt">{{custom_excerpt}}</p>
                    {{/if}}

                    {{#if feature_image}}
                    <figure class="gh-feature-image">
                        <picture>
                            <source 
                            srcset="
                            {{img_url feature_image size="xxs" format="avif"}} 30w,
                            {{img_url feature_image size="xs" format="avif"}} 100w,
                            {{img_url feature_image size="s" format="avif"}} 300w,
                            {{img_url feature_image size="m" format="avif"}} 600w,
                            {{img_url feature_image size="l" format="avif"}} 1200w,
                            {{img_url feature_image size="xl" format="avif"}} 2000w"
                            sizes="(min-width: 1200px) 1200px, 90vw" 
                            type="image/avif"
                            >
                            <source 
                            srcset="
                            {{img_url feature_image size="xxs" format="webp"}} 30w,
                            {{img_url feature_image size="xs" format="webp"}} 100w,
                            {{img_url feature_image size="s" format="webp"}} 300w,
                            {{img_url feature_image size="m" format="webp"}} 600w,
                            {{img_url feature_image size="l" format="webp"}} 1200w,
                            {{img_url feature_image size="xl" format="webp"}} 2000w"
                            sizes="(min-width: 1200px) 1200px, 90vw" 
                            type="image/webp"
                            >
                            <img
                            srcset="
                            {{img_url feature_image size="xxs"}} 30w,
                            {{img_url feature_image size="xs"}} 100w,
                            {{img_url feature_image size="s"}} 300w,
                            {{img_url feature_image size="m"}} 600w,
                            {{img_url feature_image size="l"}} 1200w,
                            {{img_url feature_image size="xl"}} 2000w"
                            sizes="(min-width: 1200px) 1200px, 90vw" 
                            src="{{img_url feature_image size="l"}}"
                            alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
                            >
                        </picture>
                        {{#if feature_image_caption}}
                            <figcaption>{{feature_image_caption}}</figcaption>
                        {{/if}}
                    </figure>
                    {{/if}}
                </header>

                <div class="gh-content gh-canvas">
                    {{content}}
                </div>

                <footer class="mt-8 gh-footer gh-canvas">

                    <div class="gh-post-authors">
                        Written by {{#foreach authors}}<a href="{{url}}">{{name}}</a>{{/foreach}}
                    </div>

                    {{#if comments}}
                    <section class="gh-post-comments">
                        {{comments}}
                    </section>
                    {{/if}}

                </footer>

            </article>

            <aside class="gh-readmore">
                <div class="gh-readmore-inner gh-container text-2xl">
                    <div class="gh-readmore-next hover:text-gray-400">
                        {{#next_post}}<a href="{{url}}" class="flex items-center">{{> "icons/arrow-left"}} <h4>{{title}}</h4></a>{{/next_post}}
                    </div>
                    <div class="gh-readmore-prev hover:text-gray-400">
                        {{#prev_post}}<a href="{{url}}">
                            <h4>{{title}}</h4> {{> "icons/arrow-right"}}
                        </a>{{/prev_post}}
                    </div>
                </div>
            </aside>
            {{/post}}
        </div>
    </div>
</div>